cmake_minimum_required(VERSION 3.7)

add_executable(TestMath TestMath.cpp ${HELPER_SOURCES})
add_executable(TestLoadSDL2 TestLoadSDL2.cpp)

# Copy bricks.jpg from Assets folder to test SDL_image
add_custom_command(TARGET TestLoadSDL2 POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
    ${CMAKE_CURRENT_LIST_DIR}/../../Assets/bricks.jpg
    $<TARGET_FILE_DIR:TestLoadSDL2>)
    
# You know, i think putting all .dll in a common dir is actually better when copying. If that was the 
# case, methods from this resource should work: https://stackoverflow.com/questions/14368919/cmake-custom-command-copy-multiple-files
add_custom_command(TARGET TestLoadSDL2 POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
        "${SDL2_LIB_DIRS}/SDL2.dll"            
        $<TARGET_FILE_DIR:TestLoadSDL2>)        

add_custom_command(TARGET TestLoadSDL2 POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
        "${SDL2_IMG_LIB_DIRS}/SDL2_image.dll"            
        $<TARGET_FILE_DIR:TestLoadSDL2>)        

add_custom_command(TARGET TestLoadSDL2 POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
        "${SDL2_IMG_LIB_DIRS}/libjpeg-9.dll"            
        $<TARGET_FILE_DIR:TestLoadSDL2>)        

target_link_libraries(TestLoadSDL2 ${SDL2_LIBRARIES})
target_link_libraries(TestLoadSDL2 ${SDL2_IMG_LIBRARIES})

add_test(Math TestMath)
add_test(LoadSDL2 TestLoadSDL2)

